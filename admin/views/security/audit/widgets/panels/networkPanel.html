<!--
 - Copyright 2021-2024 SanteSuite Contributors (See NOTICE.md for full copyright notices)
 - Copyright (C) 2019 - 2021, Fyfe Software Inc. and the SanteSuite Contributors
 - Portions Copyright (C) 2015-2018 Mohawk College of Applied Arts and Technology
 - 
 - Licensed under the Apache License, Version 2.0 (the "License"); you 
 - may not use this file except in compliance with the License. You may 
 - obtain a copy of the License at 
 - 
 - http://www.apache.org/licenses/LICENSE-2.0 
 - 
 - Unless required by applicable law or agreed to in writing, software
 - distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 - WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the 
 - License for the specific language governing permissions and limitations under 
 - the License.
 - 
 - User: fyfej
 - Date: 2023-5-19
 -->
<div xmlns="http://www.w3.org/1999/xhtml" xmlns:sdb="http://santedb.org/applet" 
    oc-lazy-load="{ name: 'AuditNetworkController', files: ['/org.santedb.admin/controllers/audit/widgets/network.js'] }" >
    <sdb:widget order="15" name="org.santedb.widget.admin.panel.audit.network" headerClass="bl-light"
        size="Large" type="Panel" context="org.santedb.securityAudit.admin">
        <sdb:icon>fas fa-network-wired</sdb:icon>
        <sdb:description lang="en">Network</sdb:description>
    </sdb:widget>

    <div class="row" ng-if="!scopedObject">
        <div class="col">
            <p class="m-auto"><i class="fas fa-circle-notch fa-spin"></i> {{ 'ui.wait' | i18n }}</p>
        </div>
    </div>

    <div ng-if="scopedObject" ng-controller="AuditNetworkController">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-4 col-md-2 offset-md-2">
                        <i class="fas"
                            ng-class="{ 'fa-user' : scopedObject.audit.actorDisplay.source.isReq , 'fa-server' : !scopedObject.audit.actorDisplay.source.isReq }"></i>
                        {{ scopedObject.audit.actorDisplay.source.uname }} <span
                            class="badge badge-info"><i
                                class="fas fa-network-wired"></i>{{ scopedObject.audit.actorDisplay.source.apId }}</span><br />
                    </div>
                    <div class="col-sm-4 col-md-2"><span class="m-auto">
                            <i class="fas text-info"
                                ng-class="{ 'fa-long-arrow-alt-left' : audit.action == 'Read', 'fa-arrows-alt-h' : scopedObject.audit.action == 'Execute', 'fa-long-arrow-alt-right' :  scopedObject.audit.action != 'Read' &amp;&amp; scopedObject.audit.action != 'Execute' }"></i>
                            <span ng-bind-html="renderAction(scopedObject.audit)"></span>
                            <i class="fas text-info"
                                ng-class="{ 'fa-long-arrow-alt-left' : scopedObject.audit.action == 'Read', 'fa-arrows-alt-h' : scopedObject.audit.action == 'Execute', 'fa-long-arrow-alt-right' :  scopedObject.audit.action != 'Read' &amp;&amp; scopedObject.audit.action != 'Execute' }"></i></span>
                    </div>
                    <div class="col-sm-4 col-md-2">
                        <i class="fas"
                            ng-class="{ 'fa-user' : scopedObject.audit.actorDisplay.destination.isReq , 'fa-server' : !scopedObject.audit.actorDisplay.destination.isReq }"></i>
                        {{ scopedObject.audit.actorDisplay.destination.uname }} <span
                            class="badge badge-info"><i
                                class="fas fa-network-wired"></i>{{ scopedObject.audit.actorDisplay.destination.apId }}</span><br />
                    </div>
                </div>
                <br />
                <div class="row" ng-if="scopedObject.audit.metaDisplay.LocalEndpoint">
                    <div class="col-xs-12 col-sm-10 offset-sm-2">
                        <label
                        class="control-label">{{ 'ui.admin.audit.network.url' | i18n }}</label>
                        <a
                            href="{{scopedObject.audit.metaDisplay.LocalEndpoint}}"
                            target="_blank">{{scopedObject.audit.metaDisplay.LocalEndpoint}}</a>"
                    </div>
                </div>
            </div>
    </div>

</div>