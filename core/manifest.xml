<!--
 - Copyright 2015-2018 Mohawk College of Applied Arts and Technology
 -
 - 
 - Licensed under the Apache License, Version 2.0 (the "License"); you 
 - may not use this file except in compliance with the License. You may 
 - obtain a copy of the License at 
 - 
 - http://www.apache.org/licenses/LICENSE-2.0 
 - 
 - Unless required by applicable law or agreed to in writing, software
 - distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 - WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the 
 - License for the specific language governing permissions and limitations under 
 - the License.
 - 
 - User: justin
 - Date: 2018-7-23
 -->
<AppletManifest xmlns="http://santedb.org/applet">
  <info id="org.santedb.core" version="1.0.0.0">
    <icon>/org.santedb.core/img/icon.png</icon>
    <name lang="en">SanteDB Core Applet</name>
    <author>Mohawk College of Applied Arts and Technology - mHealth &amp; eHealth Development &amp; Innovation Centre</author>
  </info>
  <viewModel key="base">
    <definition>/org.santedb.core/model/base.xml</definition>
  </viewModel>
  <viewModel key="min">
    <definition>/org.santedb.core/model/min.xml</definition>
  </viewModel>
  <viewModel key="full">
    <definition>/org.santedb.core/model/full.xml</definition>
  </viewModel>
  <viewModel key="fastview">
    <definition>/org.santedb.core/model/fastview.xml</definition>
  </viewModel>
  <viewModel key="dropdown">
    <definition>/org.santedb.core/model/dropdown.xml</definition>
  </viewModel>


  <subscriptions>
    <add resource="CodeSystem" name="ui.subscription.codeSystem.all" mode="*" ignoreModifiedOn="false" trigger="on-start on-x-net" />
    <add resource="ReferenceTerm" name="ui.subscription.referenceTerm.all" mode="*" ignoreModifiedOn="false" trigger="on-start on-x-net" />
    <add resource="Person" name="ui.subscription.person.all" mode="all" ignoreModifiedOn="false" trigger="always">
      <filter>classConcept=BACD9C6F-3FA9-481E-9636-37457962804D</filter>
      <filter>classConcept=9DE2A846-DDF2-4EBC-902E-84508C5089EA&amp;relationship.source.classConcept=BACD9C6F-3FA9-481E-9636-37457962804D</filter>
    </add>
    <add resource="Act" name="ui.subscription.act.all" mode="all" ignoreModifiedOn="false" trigger="always">
      <filter>classConcept=CA44A469-81D7-4484-9189-CA1D55AFECBC</filter>
      <filter>classConcept=A064984F-9847-4480-8BEA-DDDF64B3C77C</filter>
    </add>
    <add resource="Place" name="ui.subscription.place.all" mode="all" ignoreModifiedOn="false" trigger="on-start on-x-net">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5</filter>
    </add>
    <add resource="Organization" name="ui.subscription.organization.all" mode="*" ignoreModifiedOn="false" trigger="on-start on-x-net">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5</filter>
    </add>
    <add resource="UserEntity" name="ui.subscription.userEntity.all" mode="all" ignoreModifiedOn="false" trigger="on-start on-x-net">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5</filter>
    </add>
    <add resource="Provider" name="ui.subscription.provider.all" mode="all" ignoreModifiedOn="false" trigger="on-start on-x-net">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5</filter>
    </add>
    <add resource="PatientEncounter" name="ui.subscription.patientEncounter.all" mode="all" ignoreModifiedOn="false" trigger="always" />
    <add resource="SubstanceAdministration" name="ui.subscription.substanceAdministration.all" mode="all" ignoreModifiedOn="false" trigger="always" />
    <add resource="CodedObservation" name="ui.subscription.codedObservation.all" mode="all" ignoreModifiedOn="false" trigger="always" />
    <add resource="TextObservation" name="ui.subscription.textObservation.all" mode="all" ignoreModifiedOn="false" trigger="always" />
    <add resource="QuantityObservation" name="ui.subscription.quantityObservation.all" mode="all" ignoreModifiedOn="false" trigger="always" />
    <add resource="ConceptSet" name="ui.subscription.conceptSet.all" mode="*" ignoreModifiedOn="false" trigger="on-start" />
    <add resource="Concept" name="ui.subscription.concept.all" mode="*" ignoreModifiedOn="false" trigger="on-start">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5</filter>
    </add>
    <add resource="AssigningAuthority" name="ui.subscription.assigningAuthority.all" mode="*" ignoreModifiedOn="false" trigger="on-start" />
    <add resource="IdentifierType" name="ui.subscription.identifierType.all" mode="*" ignoreModifiedOn="false" trigger="on-start" />
    <add resource="TemplateDefinition" name="ui.subscription.templateDefinition.all" mode="*" ignoreModifiedOn="false" trigger="on-start" />
    <add resource="ExtensionType" name="ui.subscription.extensionType.all" mode="*" ignoreModifiedOn="false" trigger="on-start" />
    <add resource="ConceptClass" name="ui.subscription.conceptClass.all" mode="*" ignoreModifiedOn="false" trigger="on-start" />
    <add resource="Material" name="ui.subscription.material.all" mode="*" ignoreModifiedOn="false" trigger="always">
      <filter>classConcept=D39073BE-0F8F-440E-B8C8-7034CC138A95&amp;statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5</filter>
    </add>
    <add resource="ManufacturedMaterial" name="ui.subscription.manufacturedMaterial.all" mode="*" ignoreModifiedOn="false" trigger="always">
      <filter>classConcept=D39073BE-0F8F-440E-B8C8-7034CC138A95&amp;statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5</filter>
    </add>
    <add resource="Place" name="ui.subscription.place.me" mode="subscription" ignoreModifiedOn="true" trigger="always" guard="subscribed.typeConcept">
      <filter>id=$subscribed.id$</filter>
    </add>
    <add resource="Place" name="ui.subscription.place.state" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.address[Direct].component[State]">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;address.component[State].value=$subscribed.address.component[State].value$&amp;_exclude=relationship&amp;_exclude=participation</filter>
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=!FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;address.component[State].value=$subscribed.address.component[State].value$&amp;_exclude=relationship&amp;_exclude=participation</filter>
    </add>
    <add resource="Place" name="ui.subscription.place.county" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.address[Direct].component[County] &amp;&amp; !subscribed.address[Direct].component[State]">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;address.component[County].value=$subscribed.address.component[County].value$&amp;_exclude=relationship&amp;_exclude=participation</filter>
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=!FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;address.component[County].value=$subscribed.address.component[County].value$&amp;_exclude=relationship&amp;_exclude=participation</filter>
    </add>
    <add resource="Place" name="ui.subscription.place.all" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="!subscribed.address[Direct].component[County] &amp;&amp; !subscribed.address[Direct].component[State]">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;_exclude=relationship&amp;_exclude=participation</filter>
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=!FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;_exclude=relationship&amp;_exclude=participation</filter>
    </add>
    <add resource="Place" name="ui.subscription.place.outOfState" mode="subscription" ignoreModifiedOn="false" trigger="periodic" guard="subscribed.address[Direct].component[State]">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;address.component[State].value=!$subscribed.address.component[State].value$&amp;_exclude=relationship&amp;_exclude=participation</filter>
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=!FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;address.component[State].value=!$subscribed.address.component[State].value$&amp;_exclude=relationship&amp;_exclude=participation</filter>
    </add>
    <add resource="Place" name="ui.subscription.place.outOfCounty" mode="subscription" ignoreModifiedOn="false" trigger="periodic" guard="subscribed.address[Direct].component[County] &amp;&amp; !subscribed.address[Direct].component[State]">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;address.component[County].value=!$subscribed.address.component[County].value$&amp;_exclude=relationship&amp;_exclude=participation</filter>
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=!FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;address.component[County].value=!$subscribed.address.component[County].value$&amp;_exclude=relationship&amp;_exclude=participation</filter>
    </add>
    <add resource="Place" name="ui.subscription.place.assigned" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>statusConcept=!CD4AA3C4-02D5-4CC9-9088-EF8F31E321C5&amp;classConcept=!FF34DFA7-C6D3-4F8B-BC9F-14BCDC13BA6C&amp;relationship[DedicatedServiceDeliveryLocation].target=$subscribed.id$</filter>
    </add>
    <add resource="UserEntity" name="ui.subscription.userEntity.assigned" mode="subscription" ignoreModifiedOn="false" trigger="on-start on-x-net" guard="subscribed.typeConcept">
      <filter>participation[Location|EntryLocation|Destination|InformationRecipient|PrimaryInformationRecipient].player=$subscribed.id$&amp;_exclude=relationship&amp;_exclude=participation</filter>
      <filter>participation.source.participation.player=$subscribed.id$&amp;_exclude=relationship&amp;_exclude=participation</filter>
      <filter>relationship[DedicatedServiceDeliveryLocation].target=$subscribed.id$&amp;_expand=relationship&amp;_expand=participation</filter>
    </add>
    <add resource="Provider" name="ui.subscription.provider.assigned" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>participation[Location|EntryLocation|Destination|InformationRecipient|PrimaryInformationRecipient].player=$subscribed.id$&amp;_exclude=relationship&amp;_exclude=participation</filter>
      <filter>participation.source.participation.player=$subscribed.id$&amp;_exclude=relationship&amp;_exclude=participation</filter>
    </add>
    <add resource="Patient" name="ui.subscription.patient.assigned" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>relationship[ServiceDeliveryLocation|DedicatedServiceDeliveryLocation|IncidentalServiceDeliveryLocation].target=$subscribed.id$</filter>
      <filter>participation[RecordTarget].source.participation[Location].player=$subscribed.id$&amp;relationship[ServiceDeliveryLocation|DedicatedServiceDeliveryLocation|IncidentalServiceDeliveryLocation].target=!$subscribed.id$</filter>
    </add>
    <add resource="Patient" name="ui.subscription.patient.liveInCounty" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.address[Direct].component[County]">
      <filter>address.component[County].value=$subscribed.address.component[County].value$</filter>
    </add>
    <add resource="Patient" name="ui.subscription.patient.liveInState" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.address[Direct].component[State]">
      <filter>address.component[State].value=$subscribed.address.component[State].value$</filter>
    </add>
    <add resource="Person" name="ui.subscription.person.assigned" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>classConcept=9de2a846-ddf2-4ebc-902e-84508c5089ea&amp;relationship.source.classConcept=bacd9c6f-3fa9-481e-9636-37457962804d&amp;relationship.source.relationship[DedicatedServiceDeliveryLocation|IncidentalServiceDeliveryLocation|ServiceDeliveryLocation].target=$subscribed.id$</filter>
      <filter>participation[RecordTarget].source.participation[Location].player=$subscribed.id$&amp;participation[RecordTarget].source.statusConcept=C8064CBD-FA06-4530-B430-1A52F1530C27&amp;participation[RecordTarget].source.classConcept=54B52119-1709-4098-8911-5DF6D6C84140</filter>
    </add>
    <add resource="Act" name="ui.subscription.act.other.me" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>classConcept=!932A3C7E-AD77-450A-8A1F-030FC2855450&amp;classConcept=!28D022C6-8A8B-47C4-9E6A-2BC67308739E&amp;classConcept=!8CC5EF0D-3911-4D99-937F-6CFDC2A27D55&amp;classConcept=!54B52119-1709-4098-8911-5DF6D6C84140&amp;participation[Destination|Location].player=$subscribed.id$&amp;_expand=relationship&amp;_expand=participation</filter>
    </add>
    <add resource="Procedure" name="ui.subscription.act.procedure.me" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>participation[Location|EntryLocation].player=!$subscribed.id$&amp;participation[RecordTarget].player.relationship[DedicatedServiceDeliveryLocation|IncidentalServiceDeliveryLocation|ServiceDeliveryLocation].target=$subscribed.id$</filter>
      <filter>participation[Location|InformationRecipient|EntryLocation].player=$subscribed.id$</filter>
    </add>
    <add resource="SubstanceAdministration" name="ui.subscription.act.substanceAdministration.me" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>participation[Location|EntryLocation].player=!$subscribed.id$&amp;participation[RecordTarget].player.relationship[DedicatedServiceDeliveryLocation|IncidentalServiceDeliveryLocation|ServiceDeliveryLocation].target=$subscribed.id$</filter>
      <filter>participation[Location|InformationRecipient|EntryLocation].player=$subscribed.id$</filter>
    </add>
    <add resource="CodedObservation" name="ui.subscription.act.codedObservation.me" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>participation[Location|EntryLocation].player=!$subscribed.id$&amp;participation[RecordTarget].player.relationship[DedicatedServiceDeliveryLocation|IncidentalServiceDeliveryLocation|ServiceDeliveryLocation].target=$subscribed.id$</filter>
      <filter>participation[Location|InformationRecipient|EntryLocation].player=$subscribed.id$</filter>
    </add>
    <add resource="QuantityObservation" name="ui.subscription.act.quantityObservation.me" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>participation[Location|EntryLocation].player=!$subscribed.id$&amp;participation[RecordTarget].player.relationship[DedicatedServiceDeliveryLocation|IncidentalServiceDeliveryLocation|ServiceDeliveryLocation].target=$subscribed.id$</filter>
      <filter>participation[Location|InformationRecipient|EntryLocation].player=$subscribed.id$</filter>
    </add>
    <add resource="TextObservation" name="ui.subscription.act.textObservation.me" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>participation[Location|EntryLocation].player=!$subscribed.id$&amp;participation[RecordTarget].player.relationship[DedicatedServiceDeliveryLocation|IncidentalServiceDeliveryLocation|ServiceDeliveryLocation].target=$subscribed.id$</filter>
      <filter>participation[Location|InformationRecipient|EntryLocation].player=$subscribed.id$</filter>
    </add>
    <add resource="PatientEncounter" name="ui.subscription.act.PatientEncounter.me" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.typeConcept">
      <filter>participation[Location|EntryLocation].player=!$subscribed.id$&amp;participation[RecordTarget].player.relationship[DedicatedServiceDeliveryLocation|IncidentalServiceDeliveryLocation|ServiceDeliveryLocation].target=$subscribed.id$</filter>
      <filter>participation[Location|InformationRecipient|EntryLocation].player=$subscribed.id$</filter>
    </add>
    <add resource="Patient" name="ui.subscription.patient.myId" mode="subscription" ignoreModifiedOn="false" trigger="always" guard="subscribed.domainName">
      <filter>identifier.authority.name=$subscribed.domainName$</filter>
    </add>
  </subscriptions>
</AppletManifest>