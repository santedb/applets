<div xmlns="http://www.w3.org/1999/xhtml" xmlns:sdb="http://santedb.org/applet" 
    oc-lazy-load="{ name: 'EditApplicationController', files: ['/org.santedb.admin/controllers/applications/edit.js'] }" >
    <sdb:widget order="15" name="org.santedb.widget.admin.panel.applications.security"  headerClass="bl-light"
        size="Large" type="Panel" context="org.santedb.securityApplications.admin">
        <sdb:icon>fas fa-window-maximize</sdb:icon>
        <sdb:description lang="en">Security Properties</sdb:description>
    </sdb:widget>
    
    <div id="securityProps">
        <div class="form-group row">
            <label
                class="col-xs-12 col-md-2 control-label">{{ 'ui.model.securityApplication.lastAuthenticationTime' | i18n }}</label>
            <div class="col-xs-12 col-md-10" ng-if="target.securityApplication.lastAuthenticationTime">
                {{ target.securityApplication.lastAuthenticationTime | extDate: 'F' }}</div>
            <div class="col-xs-12 col-md-10" ng-if="!target.securityApplication.lastAuthenticationTime">
                {{ 'ui.admin.applications.edit.security.neverLoggedIn' | i18n }}</div>
        </div>
        <div class="form-group row" ng-if="target.securityApplication.id">
            <label
                class="col-xs-12 col-md-2 control-label">{{ 'ui.model.securityApplication.invalidAuth' | i18n }}</label>
            <div class="col-xs-12 col-md-10">
                {{ target.securityApplication.invalidAuth || 0    }}
                <button ng-click="resetInvalidLogins()" id="resetInvalidLoginsButton" type="button"
                    class="btn btn-info">
                    <i class="fas fa-undo"></i> {{ 'ui.action.reset' | i18n }}
                </button>
            </div>
        </div>
        <div class="form-group row" ng-if="target.securityApplication.lockout > $root.page.currentTime">
            <label for="lockout"
                class="col-xs-12 col-md-2 control-label">{{ 'ui.model.securityApplication.lockout' | i18n }}</label>
            <div class="col-xs-12 col-md-10">
                {{ target.securityApplication.lockout | extDate: 'F' }}
                <button ng-click="unlock()" id="unlockButton" class="btn btn-info" type="button">
                    <i class="fa fa-lock-open"></i> {{ 'ui.action.unlock' | i18n }}
                </button>
            </div>
        </div>
        <div class="form-group row" ng-if="target.securityApplication.id">
            <label
                class="col-xs-12 col-md-2 control-label">{{ 'ui.model.securityApplication.secret' | i18n }}</label>
            <div class="col-sm-12 col-md-10 input-group"
                ng-if="target.securityApplication.applicationSecret">
                <input name="secret" ng-readonly="target.securityApplication.id" type="text"
                    class="form-control" minlength="3" maxlength="64" readonly="readonly"
                    ng-model="target.securityApplication.applicationSecret" />
                <input-copy-button id="applicationsecretCopyButton" class="btn btn-outline-secondary"
                    source="target.securityApplication.applicationSecret" />
            </div>
            <div class="col-xs-12 col-md-2" ng-if="!target.securityApplication.applicationSecret">
                <button ng-click="resetSecret()" id="resetSecretButton" class="btn btn-info"
                    type="button">
                    <i class="fa fa-asterisk"></i> {{ 'ui.action.reset' | i18n }}
                </button>
            </div>
        </div>
    </div> 

    <div ng-show="target.securityApplication.id">
        <div class="card-header">
            <h2 class="mb-0">
                <button type="button" class="collapse-indicator btn btn-link p-0" data-toggle="collapse"
                    data-target="#policyGroupProps" aria-expanded="true">
                    <i class="fa fa-certificate"></i> {{ 'ui.admin.applications.edit.policy.title' | i18n }}
                    <i class="fa fa-chevron-right"></i>
                </button>
            </h2>
        </div>
        <div class="collapse show" id="policyGroupProps">
            <div class="card-body container-fluid">
                <entity-policy-admin securable="target.securityApplication" policy="target.policy">
                </entity-policy-admin>
            </div>
        </div>
    </div>
</div>